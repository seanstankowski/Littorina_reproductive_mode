Material and methods

Genome assembly and annotation
The 1.35Gb Littorina saxatilis genome was assembled into a total of 116262 scaffolds (out of which 34233 are 10kb or longer) using a combination of Illumina and PacBio reads. Briefly, illumina contig assembly was performed with soapdenovo2 (Luo et al. 2012) followed by removal of redundant contigs using the redundans software (Gabaldon, 2016) and thereafter scaffolded with PBJelly (English et al, 2012). The assembled sequences have been deposited to Dryad repository https://doi.org/XXX. The NG50 of the assembly is 55kb and the scaffolded sequence contains 4.7% gaps. BUSCO analysis to assess the completeness of the assembly was performed using BUSCO v2 (SimÃ£o et al. 2015; Waterhouse et al. 2017) at the metazoan level (978 reference orthologs) with the following results: 80.1% complete BUSCOs, 78.9% complete and single-copy BUSCOs, 1.2% complete and duplicated BUSCOs, 11.3% fragmented BUSCOs, 8.6% missing BUSCOs.

A preliminary annotation was performed on all scaffolds or contigs >= 1000bp by running two iterations of the maker pipeline v2.31.8 (Cantarel BL et al. 2008, Campbell MS et al., 2014). The maker annotation was run with in-house transcriptome evidence from Littorina saxatilis and closely related species and protein sequences from other previously published molluscs (Lottia gigantea, Crassostrea gigas and Octopus bimaculoides) as well as proteins from the UniRef90 database, (The UniProt Consortium, 2021).
Maker was run a second time after first training the gene modelers SNAP (version 2006-07-28, Korf  2004) and Augustus v3.2.2 (Stanke M et al., 2008) based on the results from the first run. The resulting preliminary annotation includes a total of 60963 gene models. Repeat regions were masked by RepeatMasker (Smit et al. 2013-2015) with known repeat elements from Repbase (Bao et al., 2015) and repeats in the Littorina genome identified de novo with RepeatModeler (Smit & Hubley, 2008-2015).
The predicted transcript and protein sequences were used for blast searches against the Swiss-Prot database (The UniProt Consortium, 2021) and the description for each best hit was transferred to the maker annotation gff as described in Campbell et al. (2014). The resulting reformatted annotation file that was used in subsequent analysis is available via Dryad repository https://doi.org/XXX.   
